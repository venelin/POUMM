<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The Phylogenetic (Ornstein-Uhlenbeck) Mixed Model — POUMM • POUMM</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="The Phylogenetic (Ornstein-Uhlenbeck) Mixed Model — POUMM" />

<meta property="og:description" content="This is the high-level entry point to the POUMM method. The POUMM
 function fits the POUMM method to a tree and observed trait-values at its tips
  and returns an object of class &quot;POUMM&quot;." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129563006-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129563006-1');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">POUMM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/UserGuide.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/InterpretingPOUMM.html">Interpreting the POUMM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The Phylogenetic (Ornstein-Uhlenbeck) Mixed Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/venelin/POUMM/blob/master/R/POUMM.R'><code>R/POUMM.R</code></a></small>
    <div class="hidden name"><code>POUMM.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is the high-level entry point to the POUMM method. The POUMM
 function fits the POUMM method to a tree and observed trait-values at its tips
  and returns an object of class "POUMM".</p>
    
    </div>

    <pre class="usage"><span class='fu'>POUMM</span>(<span class='no'>z</span>, <span class='no'>tree</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>zName</span> <span class='kw'>=</span> <span class='st'>"z"</span>, <span class='kw'>treeName</span> <span class='kw'>=</span> <span class='st'>"tree"</span>,
  <span class='kw'>parDigits</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>usempfr</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>useCpp</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>, <span class='kw'>spec</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>doMCMC</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>likPOUMM_lowLevelFun</span> <span class='kw'>=</span> <span class='no'>likPOUMMGivenTreeVTipsC</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>z</th>
      <td><p>Either a numeric vector containing the phenotypic values at the tips 
of tree or a named list containing named elements z - a numeric vector and 
tree - a phylo object (it is possible to specify different element names 
using the arguments zName and treeName).</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A phylo object or NULL in case z is a list.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>A non-negative numerical vector (or single number) indicating known 
measurement standard error (defaults to 0). Note the elements of this vector 
are assumed to describe the measurement error at individual nodes independent
of the environmental contribution (described by the parameter sigmae). The total
error standard deviation is thus sqrt(sigmae2+se^2).</p></td>
    </tr>
    <tr>
      <th>zName, treeName</th>
      <td><p>Character strings used when the parameter z is a list; 
indicate the names in the list of the values-vector and the tree. Default: 
'z' and 'tree'.</p></td>
    </tr>
    <tr>
      <th>parDigits</th>
      <td><p>Integer specifying rounding to be done on the parameter 
vector before likelihood calculation. Defaults to 6 decimal digits. This can
be useful during maximum likelihood optimization to prevent likelihood 
calculation on very small but positive values of alpha, but should be used 
with caution since specifying a small number of digits, i.e. 2 or 3 can
result in an infinite loop during optim. Specify a negative number
to disable rounding.</p></td>
    </tr>
    <tr>
      <th>usempfr</th>
      <td><p>integer indicating if and how mpfr should be used for small 
parameter values (`any(c(alpha, sigma, sigmae) &lt; 0.01)`). Using the mpfr 
package can be forced by specifying an integer greater or equal to 2. 
Setting usempfr=0 (default) causes high precision likelihood 
calculation to be done on each encounter of parameters with at least 1 bigger
log-likelihood value than any of the currently found
maximum log-likelihood or the previously calculated log-likelihood value
Requires the Rmpfr package. Note that using mpfr may increase the time for 
one likelihood calculation more than 100-fold. Set usempfr to -1 or less
to completely disable Rmpfr functionality.</p></td>
    </tr>
    <tr>
      <th>useCpp</th>
      <td><p>Logical indicating whether C++ likelihood calculation should be 
used for faster vector operations. Defaults to TRUE. Since the C++ likelihood
implementation does not support mpfr, useCpp gets disabled when usempfr is 
bigger than 0.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to the `likPOUMMGivenTreeVTips()` function 
(`?dVGivenTreeOU` for details).</p></td>
    </tr>
    <tr>
      <th>spec</th>
      <td><p>A named list specifying how the ML and MCMC fit should be done. 
See `?specifyPOUMM`.</p></td>
    </tr>
    <tr>
      <th>doMCMC</th>
      <td><p>Deprecated - replaced by specifying nSamplesMCMC as a member
of spec instead (see `?specifyPOUMM`). 
logical: should a MCMC fit be performed. An MCMC fit provides a 
sample from the posterior distribution of the parameters given a prior 
distribution and the data. Unlike the ML-fit, it allows to estimate 
confidence intervals for the estimated parameters. This argument is TRUE by 
default. The current implementation uses the adaptive 
Metropolis sampler from the package `adaptMCMC` written by Andreas 
Scheidegger. To obtain meaningful estimates MCMC may need to run for several
millions of iterations (parameter nSamplesMCMC set to 1e5 by default). See 
parameters ending at MCMC in `?specifyPOUMM` for details.</p></td>
    </tr>
    <tr>
      <th>likPOUMM_lowLevelFun</th>
      <td><p>the low-level function used for POUMM - likelihood 
calculation. Default value is likPOUMMGivenTreeVTipsC.</p></td>
    </tr>
    <tr>
      <th>verbose, debug</th>
      <td><p>Logical flags indicating whether to print informative 
and/or debug information on the standard output (both are set to to FALSE by
default).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of S3 class 'POUMM'. This object can be analyzed using 
 S3 generic functions: <code><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></code>, 
 <code><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>AIC</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>BIC</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></code>,
 <code><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/fitted.values'>fitted</a></code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mitov, V., and Stadler, T. (2017). Fast and Robust Inference of Phylogenetic Ornstein-Uhlenbeck Models Using Parallel Likelihood Calculation. bioRxiv, 115089. 
 https://doi.org/10.1101/115089
 Mitov, V., &amp; Stadler, T. (2017). Fast Bayesian Inference of Phylogenetic Models Using Parallel Likelihood Calculation and Adaptive Metropolis Sampling. Systematic Biology, 235739. http://doi.org/10.1101/235739  
 Vihola, M. (2012). Robust adaptive Metropolis algorithm with coerced 
 acceptance rate. Statistics and Computing, 22(5), 997-1008. 
 http://doi.org/10.1007/s11222-011-9269-5</p> 
<p>Scheidegger, A. (2012). adaptMCMC: Implementation of a generic adaptive 
 Monte Carlo Markov Chain sampler. 
 http://CRAN.R-project.org/package=adaptMCMC</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='specPOUMM.html'>specifyPOUMM</a></code> for parametrizations and custom settings
 of the POUMM fit.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Please, read the package vignette for more detailed examples.</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>
<span class='no'>tr</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/ape/topics/rtree'>rtree</a></span>(<span class='no'>N</span>)
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rVNodesGivenTreePOUMM.html'>rVNodesGivenTreePOUMM</a></span>(<span class='no'>tr</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)[<span class='fl'>1</span>:<span class='no'>N</span>]
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>POUMM</span>(<span class='no'>z</span>, <span class='no'>tr</span>, <span class='kw'>spec</span> <span class='kw'>=</span> <span class='fu'><a href='specPOUMM.html'>specifyPOUMM</a></span>(<span class='kw'>nSamplesMCMC</span> <span class='kw'>=</span> <span class='fl'>5e4</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>AIC</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>BIC</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/fitted.values'>fitted</a></span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/residuals'>resid</a></span>(<span class='no'>fit</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>h</span><span class='kw'>=</span><span class='fl'>0</span>)

<span class='co'># fit PMM to the same data and do a likelihood ratio test</span>
<span class='no'>fitPMM</span> <span class='kw'>&lt;-</span> <span class='fu'>POUMM</span>(<span class='no'>z</span>, <span class='no'>tr</span>, <span class='kw'>spec</span> <span class='kw'>=</span> <span class='fu'><a href='specPOUMM.html'>specifyPMM</a></span>(<span class='kw'>nSamplesMCMC</span> <span class='kw'>=</span> <span class='fl'>5e4</span>))
<span class='kw pkg'>lmtest</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/lmtest/topics/lrtest'>lrtest</a></span>(<span class='no'>fitPMM</span>, <span class='no'>fit</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

